<%= stylesheet_link_tag "index.css" %>

<% content_for :javascript do %>
  <script type="text/javascript">
    ShopifyApp.ready(function(){
      ShopifyApp.Bar.initialize({
        title: "Home",
        icon: "<%= asset_path('favicon.ico') %>"
      });
    });
  </script>
<% end %>

<h1><b><u>Welcome to Recommendation Station!</u></b></h1>

<h2>To view recommendations for a specific product, just click on its name.</h2>

<%= form_tag("/search", method: "get") do %>
  <%= submit_tag("Search") %>
  <%= text_field_tag(:text_field) %>
  <%= label_tag(:collection,"Collections: ") %>  
  <%= select_tag(:collection,options_for_select(@collections.map {|collect| [collect.title,collect.id]}),{:include_blank => 'None'}) %>  
  <%= label_tag(:type,"Type: ") %>
  <%= select_tag(:type,options_for_select([['yo', 1], ['asd', 2]]),{:include_blank => 'None'}) %>
<% end %>

<div id="product_table">
  <table>
    <tr>
      <th>Product</th>
      <th>Name</th>
      <th>Matches</th>
    </tr>
    
    <% @products.each do |product| %>
      <tr>
        
        <td>
          <img src = "<%= product.images[0].src %>" alt = "<%= product.title %>" style = "width:50px;height:50px;" >
        </td> 
          
        <td>
          <%= link_to product.title, "https://#{@shop_session.url}/admin/products/#{product.id}", target: "_top" %>
        </td> 
        
        <td>
          <a href="#" onclick="newModal('<%= rec_modal_url %>','Recomendations for <%=product.title%>',250,75)">
            <%=get_number_of_matches(product.id)%>
          </a>
        </td> <!--This will be the number of matches found for the product-->
      </tr>
    <% end %>
    
  </table>
</div>